# [심화학습] 컴파일과 메모리 관리

## 컴파일 과정
<img width="589" alt="Screen Shot 2022-10-02 at 2 42 38 PM" src="https://user-images.githubusercontent.com/77275707/193439872-89f5e46a-3065-4c01-8a64-f3fd6e9b5eb8.png">

* C언어나 자바로 작성한 코드는 컴파일 과정을 거쳐 목적 코드가 된다. 컴파일러는 고급 언어로 작성된 소스코드를 기계어로 번역하면서 여러 작업을 수행한다. (오류 점검, 최적화를 통해 필요없는 코드, 변수 제거 등) 이렇게 만들어진 기계어 코드가 **목적어 코드** 이다. 기계어 코드라고 하지않고 목적어 코드라고 하는 것은 아직 처리할 단계가 남아있다는 걸 의미한다. 
* 목적 코드를 만들고 난 다음 연결 단계이다. 이 단계에서 목적 코드에 라이브러리 코드를 삽입하여 최종 실행 파일을 만든다. 
* 라이브러리: 미리 만들어진 함수들을 모아놓은 파일로, 대표적인 라이브러리는 입출력 관련 함수를 모아놓은 <stdio.h>이다. 
<br>

*****

<br>

## 변수와 메모리 할당
* 컴파일러에 대해 자세히 살펴본 이유는 컴파일과 메모리 사이에 밀접한 연관 관계가 있기 때문이다. 컴파일 과정에서 가장 중요한 것은 **메모리를 확보하고 정리하는 부분**이다. 

```
char str='a';
int vol=7;
float pri=2.3;
```

<img width="683" alt="Screen Shot 2022-10-02 at 2 52 08 PM" src="https://user-images.githubusercontent.com/77275707/193440100-105bdc91-3544-4b2e-a22c-a56fa25c3d49.png">

* 기계어는 메모리 주소를 사용한다. 따라서 char str='a';는 기계에에서는 메모리 주소 0번지에 a를 넣으라는 명령으로 번역되어 컴파일러는 0번지에 a를 넣고 이곳을 문자형이 들어가는 공간으로 기억한다. 다른 명령도 마찬가지다. 

* 위의 예에서 char, int, float는 보관하려는 자료의 형태를 나타낼 뿐 아니라 사용하려는 메모리의 크기를 나타내기도 한다. 컴파일러마다 다르지만 보통의 경우 문자형은 1B, 정수형은 4B, 실수형은 8B를 사용한다. 따라서 컴파일러는 프로그래머가 지정한 자료형의 크기에 따라 메모리를 확보하고 그곳에 적당한 값을 집어넣는다. 모든 변수에 대해 메모리를 확보하고 오류를 찾기 위해 심벌 테이블을 유지한다.

<img width="353" alt="Screen Shot 2022-10-02 at 2 55 26 PM" src="https://user-images.githubusercontent.com/77275707/193440180-a7816651-4d94-41df-8f7b-be73b3f27ae8.png">

* 그림에서 보듯이 각 변수는 이름, 종류, 범위, 주소를 갖는다. 
    * 범위: 각 변수를 사용할 수 있는 영역 Scope
    * 크기: 변수의 종류마다 크기가 정해져 있기 때문에 변수의 시작 주소만 명시하면 크기는 자동으로 정해진다. 
    * 변수는 메모리 주소의 또다른 이름이다. - 기계어는 메모리 주소만 필요로 하는데도 변수를 사용하는 이유: 프로그래머가 주소값으로 기억하기 어렵기 때문
* 예시: 휴대전화 번호에 전화번호와 함께 이름이 함께 저장되어야 유저는 헷갈리지 않고 전화할 수 있다. 
<img width="203" alt="Screen Shot 2022-10-02 at 2 58 44 PM" src="https://user-images.githubusercontent.com/77275707/193440260-ae1be913-cc9e-4209-8a93-b52f87a12d7b.png">

<br>

*****

<br>

## 정리
* 컴파일러는 프로그래머가 만든 변수를 적당한 크기의 메모리로 변환하여 기계어로 바꾼다. 
* 컴파일러에 의해 만들어진 주소는 상대 주소이다. 사용자의 주소 0번지는 실제 메모리의 주소로 변환되며 이는 메모리 관리자가 담당한다. 
* 프로그래머는 주소가 항상 0번지부터 시작된다고 가정하고 프로그래밍하면 된다. 

