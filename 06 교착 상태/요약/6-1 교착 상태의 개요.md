# 교착상태의 개요
## 교착상태의 정의
2개 이상의 프로세스가 다른 프로세스의 작업이 끝나기만 기다리며 작업을 더 이상 진행하지 못하는 상태<br>
<br>

* 아사현상과 교착상태는 비슷하지만 차이점이 존재한다. 
  * 아사현상: 운영체제가 잘못된 정책을 사용하여 특정 프로세스의 작업이 지연되는 문제
  * 교착상태: 여러 프로세스가 작업을 진행하다보니 자연스럽게 일어나는 문제 
    * 따라서 운영체제는 감시를 하다가 교착상태가 발생하면 강압적으로 해결함

<br>

## 교착상태의 발생
컴퓨터 시스템에서 교착 상태는 시스템 자원, 공유 변수(또는 파일), 응용 프로그램 등을 사용할 때 발생할 수 있다. <br>
<br>
* 시스템 자원
  * 다른 프로세스와 공유할 수 없는 자원을 사용할 때 발생한다. 동시에 같이 사용될 수 없는 시스템 자원을 할당받은 후 양보하지 않는 경우를 예로 들 수 있다. 
<img width="544" alt="Screen Shot 2022-09-30 at 3 00 06 AM" src="https://user-images.githubusercontent.com/77275707/193107405-3ac61aa7-8d55-4fe8-9217-98b39e4b2616.png">

* 공유 변수
  * 공유 변수를 사용할 때도 교착 상태가 발생할 수 있다. 
  * 그림 [6-4]는 임계구역 문제를 해결하기 위한 코드로, 무한 대기를 막지 못해 교착 상태가 발생한 경우이다. 
  * 프로세스 p1이 lock1을 true로 만든 다음 p2가 lock2를 true로 만들었다고 가정하면 p1은 while(lock2==true)가 실행되어 무한 반복하고 p2도 while(lock1==true)가 되어 무한반복된다. 
    * 이 경우 p1과 p2는 둘 다 임계구역에 들어가지 못하는 교착 상태가 발생한다. 이처럼 한 변수를 할당받은 상태에서 다른 변수를 기다리면 교착 상태가 발생한다.  
<img width="641" alt="Screen Shot 2022-09-30 at 3 02 42 AM" src="https://user-images.githubusercontent.com/77275707/193108032-32b74a20-c35d-417e-b298-d8e2f1687227.png">

* 응용 프로그램
  * 데이터베이스 같은 응용프로그램에서도 교착 상태가 발생한다. 여러 프로세스가 데이터베이스에 저장된 데이터를 사용할 때 데이터의 **일관성**을 유지해야 한다. 
  * 데이터베이스는 데이터의 일관성을 유지하기 위해 잠금을 사용하는데 이 때 교착 상태가 발생할 수 있다. 
<br>

## 자원 할당 그래프
프로세스가 어떤 자원을 사용 중이고 어떤 자원을 기다리고 있는지를 방향성이 있는 그래프로 표현한 것이다. 자원 할당 그래프를 사용하면 어떤 프로세스에 자원이 할당되어 있는지 혹은 어떤 프로세스가 기다리고 있는지를 한눈에 파악할 수 있다. 
<br>

### 하나의 자원과 하나의 프로세스
프로세스: 원 / 자원: 사각형 <br>
<img width="551" alt="Screen Shot 2022-09-30 at 3 10 43 AM" src="https://user-images.githubusercontent.com/77275707/193110362-1c0eb67c-713d-4218-bd5d-13dc05a9cd7f.png">
* 자원을 사용하고 있는 경우 자원으로부터 프로세스로 향하는 화살표로 표시
* 프로세스가 자원을 기다리는 경우는 프로세스로부터 자원으로 향하는 화살표로 표시
<br>

### 다중자원: 자원이 2개 이상의 프로세스를 동시에 허용하는 경우
* 다중 자원은 수용할 수 있는 프로세스 수를 사각형 안에 작은 동그라미로 표현한다. 
* 왼쪽 그림처럼 작은 동그라미가 2개 있으면 그 자원을 2개의 프로세스가 동시에 사용할 수 있다는 의미이다. 
* 오른쪽 그림은 앞에서 말한 교착상태를 표현한다. 
<img width="621" alt="Screen Shot 2022-09-30 at 3 14 51 AM" src="https://user-images.githubusercontent.com/77275707/193111142-395b37e2-854c-48d6-b06a-f41c7b4f517c.png">
<br>

### 교착상태를 잘 설명하는 예시: 식사하는 철학자 문제
<img width="697" alt="Screen Shot 2022-09-30 at 3 17 40 AM" src="https://user-images.githubusercontent.com/77275707/193111649-b21b0826-0120-4397-aa51-bdfcdf64f8a1.png">

* 교착 상태가 발생하는 조건

1. 철학자들은 서로 포크를 공유할 수 없다. 
  -> 자원을 공유하지 못하면 교착 상태가 발생한다. <br>
2. 각 철학자는 다른 철학자의 포크를 빼앗을 수 없다.
  -> 자원을 빼앗을 수 없으면 자원을 놓을 때까지 기다려야 하므로 교착상태가 발생한다. <br>
3. 각 철학자는 왼쪽 포크를 잡은 채 오른쪽 포크를 기다린다.
  -> 자원 하나를 잡은 상태에서 다른 자원을 기다리면 교착 상태가 발생한다. <br>
4. 자원 할당 그래프가 원형이다. 
  -> 자원을 요구하는 방향이 원을 이루면 양보를 하지 않기 때문에 교착 상태가 발생한다. <br>
